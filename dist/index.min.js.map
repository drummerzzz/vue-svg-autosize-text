{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.min.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ConfiguredWrapper = exports.default = void 0;\nvar SVG_NS = 'http://www.w3.org/2000/svg';\nvar alignments = {\n  'top': true,\n  'baseline': true,\n  'bottom': true,\n  'middle': true\n};\n\nfunction getConfig(mod, cfg) {\n  var ret = {\n    'plain': !cfg.plain ? false : true,\n    'width': null || cfg.width,\n    'height': null || cfg.height,\n    'align': cfg.align === 'none' || cfg.align === false ? false : alignments[cfg.align] ? cfg.align : 'baseline',\n    'lineHeight': cfg.lineHeight || '1.125em',\n    'paddingLeft': !cfg.paddingLeft ? !cfg.padding ? 0 : cfg.padding : cfg.paddingLeft,\n    'paddingRight': !cfg.paddingRight ? !cfg.padding ? 0 : cfg.padding : cfg.paddingRight,\n    'afterReflow': cfg.afterReflow instanceof Function ? cfg.afterReflow : false,\n    'physicalMeasurement': cfg.physicalMeasurement ? true : false,\n    // 'x': cfg.x ? 100 : 500\n    // 'y': !cfg.y ? 0 : cfg.y\n  };\n  ret._padding = ret.paddingLeft + ret.paddingRight;\n\n  for (var k in mod) {\n    if (k === 'plain') ret.plain = true; else if (alignments[k]) {\n      ret.align = k;\n    } else if (k === 'none') {\n      ret.align = false;\n    } else if (/\\d+/.test(k)) ret.width = parseInt(k);\n  }\n\n  return ret;\n}\n\nfunction newLine(el, span, config) {\n  var tmp = span.cloneNode();\n  el.insertBefore(tmp, span.nextSibling);\n  span.style.display = '';\n  tmp.removeAttribute('y');\n  tmp.setAttribute('dy', config.lineHeight);\n  if (config.x) tmp.setAttribute('x', config.x);\n  // if (!config.align) tmp.setAttribute('x', config.paddingLeft);else tmp.setAttribute('x', 0);\n  return tmp;\n}\n\nfunction resizeWidth(el, text, config) {\n  el[config.plain ? 'textContent' : 'innerHTML'] = text || '';\n  var pscale = config.physicalMeasurement ? 1 : el.__OWNING_SVG.viewBox.animVal.width / el.__OWNING_SVG.getBoundingClientRect().width;\n  var plain = [];\n\n  for (var i = 0; i < el.childNodes.length; i++) {\n    var n = el.childNodes[i];\n\n    if (n instanceof Text) {\n      var tmp = document.createElementNS(SVG_NS, 'tspan');\n      tmp.textContent = n.textContent;\n      el.replaceChild(tmp, n);\n      n = tmp;\n    }\n\n    if (config.width) {\n      plain.push(n.textContent.split(/\\s/));\n      n.textContent = '';\n    }\n  }\n\n  if (config.align) {\n    el.childNodes[0].setAttribute('x', config.paddingLeft);\n  }\n\n  if (config.width) {\n    for (var _i = 0; _i < el.childNodes.length; _i++) {\n      var _n = el.childNodes[_i];\n\n      if (_n instanceof Text) {\n        var _tmp = document.createElementNS(SVG_NS, 'tspan');\n\n        _tmp.textContent = _n.textContent;\n        el.replaceChild(_tmp, _n);\n        _n = _tmp;\n      }\n\n      plain.push(_n.textContent.split(/\\s/));\n    }\n\n    var offset = 0,\n      w = config.width - config._padding,\n      // t = w\n      childCnt = el.childElementCount;\n\n    for (var c = 0; c < childCnt; c++) {\n      var words = plain[c];\n      var wc = words.length,\n        span = el.childNodes[c + offset],\n        txt = '',\n        forceBreak = false;\n\n      for (var _i2 = 0; _i2 < wc; _i2++) {\n        span.textContent += _i2 ? ' ' + words[_i2] : words[_i2];\n        forceBreak = el.getBoundingClientRect().width * pscale > w;\n        // forceResize = el.getBoundingClientRect(). * pscale > h;\n\n        while (forceBreak) {\n          span.textContent = txt;\n          span = newLine(el, span, config);\n          txt = span.textContent = words[_i2];\n          offset++;\n\n          if (el.getBoundingClientRect().width * pscale > w) {\n            span.style.display = 'none';\n            txt = words[++_i2];\n            if (!txt) forceBreak = false;\n          } else forceBreak = false;\n        }\n\n        txt = span.textContent;\n      }\n    }\n  }\n}\n\nfunction set(el, text, config) {\n  el[config.plain ? 'textContent' : 'innerHTML'] = text || '';\n  var pscale = config.physicalMeasurement ? 1 : el.__OWNING_SVG.viewBox.animVal.width / el.__OWNING_SVG.getBoundingClientRect().width;\n  el.setAttribute('font-size', 150)\n\n  resizeWidth(el, text, config)\n\n  if (config.height) {\n    let forceResize = el.getBoundingClientRect().height * pscale > config.height;\n    while (forceResize) {\n      let size = el.getAttribute('font-size');\n      let height = el.getBoundingClientRect().height * pscale;\n      if (height > config.height) {\n        el.setAttribute('font-size', size - 1);\n      } else {\n        forceResize = false\n        resizeWidth(el, text,config)\n      }\n    }\n  }\n\n  if (!el.childNodes.length) return;\n\n  for (var _i3 = 0; _i3 < el.childNodes.length; _i3++) {\n    el.childNodes[_i3].style.display = '';\n  }\n\n  // if (config.align === 'middle') el.setAttribute('transform', \"translate(\".concat(config.paddingLeft, \", \").concat(-(el.getBoundingClientRect().height - 1.5 * h0) / 2, \")\"));else if (config.align === 'baseline') el.setAttribute('transform', \"translate(\".concat(config.paddingLeft, \", 0)\"));else if (config.align === 'bottom') el.setAttribute('transform', \"translate(\".concat(config.paddingLeft, \", \").concat(-(el.getBoundingClientRect().height - h0), \")\"));else if (config.align === 'top') el.setAttribute('transform', \"translate(\".concat(config.paddingLeft, \", \").concat(h0, \")\"));\n}\n\n// function resizeWidth (config) {\n\n// }\n\nfunction directive(config) {\n  if (!config) config = {};\n  var r = {\n    inserted: function inserted(el, binding) {\n      if (!(el instanceof SVGTextElement)) throw new Error('Text-wrap directive must be bound to an SVG text element.');\n      el.__WRAP_CONFIG = getConfig(binding.modifiers, config);\n      el.__OWNING_SVG = el.parentNode;\n\n      while (!(el.__OWNING_SVG instanceof SVGSVGElement)) {\n        el.__OWNING_SVG = el.__OWNING_SVG.parentNode;\n      }\n\n      r.update.apply(this, arguments);\n    },\n    update: function update(el, binding, _ref) {\n      var context = _ref.context; \n\n      if (binding.value != binding.oldValue) {\n        var cfg = el.__WRAP_CONFIG;\n\n        if (binding.value && typeof binding.value !== 'string') {\n          var text = binding.value.text;\n          cfg = getConfig({}, Object.assign({}, el.__WRAP_CONFIG, binding.value));\n          set(el, text, cfg);\n        } else set(el, binding.value, cfg);\n\n        if (cfg.afterReflow) cfg.afterReflow.call(context, el, cfg);\n      }\n    },\n    unbind: function unbind(el) {\n      delete el.__WRAP_CONFIG;\n    }\n  };  \n  return r;\n}\n\nvar Wrapper = directive();\nvar _default = Wrapper;\nexports.default = _default;\nvar ConfiguredWrapper = directive;\nexports.ConfiguredWrapper = ConfiguredWrapper;\n\n//# sourceMappingURL=index.js.map"]}